(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7378:function(e,t,l){Promise.resolve().then(l.bind(l,4067))},4067:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return j}});var n=l(7437),i=l(2265),s=l(6785),a=l(197),o=l(3775);l(715);var r=l(7891),d=l.n(r);let c="root";function u(e,t){let{elkNode:l,parentNode:n,zIndex:i=0}=e;t({elkNode:l,parentNode:n,zIndex:i}),l.children&&l.children.forEach(e=>u({elkNode:e,parentNode:l,zIndex:i+1},t))}let h=new(d());async function p(e){var t;let l,n;return u({elkNode:e},e=>{let{elkNode:t}=e;t.children&&(t.layoutOptions={"elk.algorithm":"layered","elk.layered.spacing.nodeNodeBetweenLayers":"50","elk.spacing.labelLabel":"5","elk.padding":"[top=40,left=15,bottom=15,right=15]","elk.direction":"RIGHT",...t.layoutOptions})}),t=await h.layout(e),l=[],n=[],u({elkNode:t},e=>{let{elkNode:t,parentNode:i,zIndex:s=0}=e;t.id!==c&&l.push({id:t.id,data:{label:t.labels&&t.labels[0].text},position:{x:t.x||0,y:t.y||0},parentId:i&&i.id!==c?i.id:void 0,zIndex:s}),t.edges&&t.edges.forEach(e=>{n.push({id:e.id,source:e.sources[0],target:e.targets[0],zIndex:s+1})})}),{nodes:l,edges:n}}async function x(e){return fetch(e).then(e=>e.json()).catch(e=>{throw console.error(e),e})}var f=l(7358);function b(e){let t=e.indexOf("(")||0;return{name:-1!==t?e.substring(0,t):e,para:-1!==t?e.substring(t):""}}var g=(0,i.memo)(function(e){let{data:t,targetPosition:l,sourcePosition:i,isConnectable:a,selected:o}=e,{name:r,para:d}=b((null==t?void 0:t.label)||"");return(0,n.jsxs)("div",{className:"h-full",children:[(0,n.jsx)(f.pM,{color:"#94a3b8",isVisible:o}),(0,n.jsx)(s.HH,{className:"invisible",type:"target",position:l||s.Ly.Left,isConnectable:a}),(0,n.jsxs)("article",{className:"text-clip whitespace-normal break-all text-wrap antialiased text-gray-700 text-center h-full",children:[(0,n.jsx)("h3",{className:"font-bold my-1",children:r}),(0,n.jsx)("p",{className:"line-clamp-3 h-full",children:d})]}),(0,n.jsx)(s.HH,{className:"invisible",type:"source",position:i||s.Ly.Right,isConnectable:a})]})});let m={SubFlow:(0,i.memo)(function(e){let{data:t,targetPosition:l,sourcePosition:i,isConnectable:a,selected:o}=e,{name:r,para:d}=b((null==t?void 0:t.label)||"");return(0,n.jsxs)("div",{className:"h-full",children:[(0,n.jsx)(f.pM,{color:"#94a3b8",isVisible:o}),(0,n.jsx)(s.HH,{className:"invisible",type:"target",position:l||s.Ly.Left,isConnectable:a}),(0,n.jsxs)("article",{className:"text-wrap antialiased text-gray-700 text-center",children:[(0,n.jsx)("h3",{className:"font-bold my-1",children:r}),(0,n.jsx)("p",{className:"line-clamp-3",children:d}),(0,n.jsx)("hr",{}),(0,n.jsx)("div",{className:"h-full opacity-70"})]}),(0,n.jsx)(s.HH,{className:"invisible",type:"source",position:i||s.Ly.Right,isConnectable:a})]})}),Step:g};function y(e){let{nodes:t,edges:l}=e,n=new Set;return t.forEach(e=>{e.parentId&&n.add(e.parentId)}),{layoutNodes:t.map(e=>({className:"px-2 py-0.5 bg-white rounded-lg shadow-lg border-solid border-neutral-200 border-1 "+(n.has(e.id)?"":"max-w-xs"),deletable:!1,connectable:!1,extent:e.parentId?"parent":void 0,type:n.has(e.id)?"SubFlow":"Step",expandParent:!0,targetPosition:s.Ly.Left,sourcePosition:s.Ly.Right,...e})),layoutEdges:l.map(e=>({animated:!0,deletable:!1,focusable:!1,markerEnd:{type:s.QZ.ArrowClosed},...e}))}}function w(){let{fitView:e}=(0,s._K)(),[t,l,r]=(0,s.Rr)([]),[d,u,h]=(0,s.ll)([]),f=()=>{(async()=>{let e=await x("/flow"),{layoutNodes:t,layoutEdges:n}=y(await p(e));l(t),u(n)})(),window.requestAnimationFrame(()=>e())};return(0,i.useLayoutEffect)(f,[]),(0,n.jsxs)(s.x$,{nodes:t,edges:d,onNodesChange:r,onEdgesChange:h,fitView:!0,nodeTypes:m,maxZoom:10,minZoom:.1,children:[(0,n.jsx)(a.A,{}),(0,n.jsxs)(s.s_,{position:"top-right",children:[(0,n.jsx)("button",{className:"text-stone-800",onClick:f,children:"Refresh"}),(0,n.jsx)("p",{}),(0,n.jsx)("button",{className:"text-stone-800",onClick:()=>{p(function(e){let{nodes:t,edges:l}=e,n={id:c,children:[],edges:[]},i=new Map,s=new Map;return i.set(c,n),t.forEach(e=>{var t;let l;let n=i.get(e.id);n||(n={id:e.id,x:e.position.x,y:e.position.y,width:null===e.width?void 0:e.width,height:null===e.height?void 0:e.height,labels:[{text:e.data.label}],children:[],edges:[]},i.set(e.id,n));let a=e.parentId||c;s.set(e.id,a),(l=i.get(a))||(l={id:a,children:[]},i.set(a,l)),null==l||null===(t=l.children)||void 0===t||t.push(n)}),l.forEach(e=>{let t=i.get(e.source),l=i.get(e.target);if(t&&l){let a={id:e.id,sources:[t.id],targets:[l.id]},o=s.get(e.source);if(o){let e=i.get(o);if(e){var n;null===(n=e.edges)||void 0===n||n.push(a)}}}}),n}({nodes:t,edges:d})).then(e=>{let{nodes:t,edges:n}=e,{layoutNodes:i,layoutEdges:s}=y({nodes:t,edges:n});l(i),u(s)}).catch(e=>console.error(e))},children:"Layout"})]}),(0,n.jsx)(o.Z,{})]})}function j(){return(0,n.jsx)(s.tV,{children:(0,n.jsx)(w,{})})}}},function(e){e.O(0,[489,780,619,52,971,23,744],function(){return e(e.s=7378)}),_N_E=e.O()}]);